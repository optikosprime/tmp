<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Touch to Record</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        background: black;
        height: 100%;
        overflow: hidden;
      }
      #whiteStrip {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 20%;
        background: white;
        display: none;
        z-index: 2;
      }
      video {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="whiteStrip"></div>
    <video id="video" autoplay playsinline></video>
    <script>
      let started = false;

      function goFullscreen() {
        const elem = document.documentElement;
        if (elem.requestFullscreen) elem.requestFullscreen();
        else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
        else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
      }

      async function startRecording() {
        if (started) return;
        started = true;
        try {
          const stream = await navigator.mediaDevices.getUserMedia({
            video: {
              facingMode: "user",
            },
            audio: false,
          });
          const video = document.getElementById("video");
          video.srcObject = stream;
          let chunks = [];
          const recorder = new MediaRecorder(stream);
          recorder.ondataavailable = (e) => chunks.push(e.data);
          recorder.onstop = () => {
            const blob = new Blob(chunks, { type: "video/webm" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "recording.webm";
            a.click();
            URL.revokeObjectURL(url);
            stream.getTracks().forEach((track) => track.stop());
          };
          recorder.start();
          setTimeout(() => {
            document.getElementById("whiteStrip").style.display = "block";
          }, 500);
          setTimeout(() => {
            recorder.stop();
          }, 3000);
        } catch (err) {
          alert("Camera access failed: " + err.message);
        }
      }

      function startApp() {
        goFullscreen();
        startRecording();
      }

      document.body.addEventListener("click", startApp, { once: true });
      document.body.addEventListener("touchstart", startApp, { once: true });
    </script>
  </body>
</html>
